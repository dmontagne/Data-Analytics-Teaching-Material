filter(oldest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T)) %>%
mutate(age_cat = "oldest_under6")
youngest_under6 <- age_splits %>%
group_by(year) %>%
filter(youngest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T)) %>%
mutate(age_cat = "youngest_under6")
View(youngest_under6)
youngest_under6 <- age_splits %>%
group_by(year) %>%
filter(youngest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest_under6")
View(youngest_under6)
oldest_under6 <- age_splits %>%
group_by(year) %>%
filter(oldest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "oldest_under6")
View(oldest_under6)
youngest6_11 <- age_splits %>%
group_by(year) %>%
filter(youngest6_11 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest6_11")
View(youngest6_11)
youngest_above6 <- age_splits %>%
group_by(year) %>%
filter(youngest_above6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest_above6")
youngest_above11 <- age_splits %>%
group_by(year) %>%
filter(youngest_above11 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest_above11")
View(youngest_above11)
View(youngest_under6)
morethan3ch <- age_splits %>%
group_by(year) %>%
filter(morethan3ch == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "morethan3ch")
age_splits <- children %>%
mutate(oldest_under6 = ifelse(maxchage < 6, 1, 0),
youngest_under6 = ifelse(minchage < 6, 1, 0),
youngest6_11 = ifelse(minchage >= 6 & minchage <= 11, 1, 0),
youngest_above11 = ifelse(minchage > 11 & minchage < 19, 1, 0),
lessthan4ch = ifelse(numch < 4, 1, 0),
morethan3ch = ifelse(numch > 3, 1, 0),
over65 = ifelse(maxchage >= 65, 1, 0)) %>%
select(YY1, rnwpov, incpov, year, minchage, maxchage, oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65,
lessthan3ch, morethan3ch, weight)
lessthan4ch <- age_splits %>%
group_by(year) %>%
filter(lessthan4ch == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "lessthan4ch")
lessthan4ch <- age_splits %>%
group_by(year) %>%
filter(lessthan4ch == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "lessthan4ch")
age_splits <- children %>%
mutate(oldest_under6 = ifelse(maxchage < 6, 1, 0),
youngest_under6 = ifelse(minchage < 6, 1, 0),
youngest6_11 = ifelse(minchage >= 6 & minchage <= 11, 1, 0),
youngest_above11 = ifelse(minchage > 11 & minchage < 19, 1, 0),
lessthan4ch = ifelse(numch < 4, 1, 0),
morethan3ch = ifelse(numch > 3, 1, 0),
over65 = ifelse(maxchage >= 65, 1, 0)) %>%
select(YY1, rnwpov, incpov, year, minchage, maxchage, oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65,
lessthan4ch, morethan3ch, weight)
lessthan4ch <- age_splits %>%
group_by(year) %>%
filter(lessthan4ch == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "lessthan4ch")
over65 <- age_splits %>%
group_by(year) %>%
filter(over65 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "over65")
rbind(oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65, morethan3ch, lessthan4ch)
age_split_pov <- rbind(oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65, morethan3ch, lessthan4ch)
View(age_split_pov)
age_splits %>%
group_by(year) %>%
filter(over65 == 1)
over65 <- age_splits %>%
group_by(year) %>%
filter(over65 == 1) %>% summarise(years = length(unique(year)))
View(over65)
over65 <- age_splits %>%
group_by(year) %>%
filter(over65 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "over65")
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_line()
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_line()
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_smooth()
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_lineh()
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_line()
getwd()
setwd("~/Documents/GitHub/inc_net_poverty_project/")
write.csv(age_split_pov, file = "poverty_by_age_categories.csv")
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_bar()
ggplot(age_split_pov, aes(x = year, color = age_cat)) +
geom_bar()
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_col()
ggplot(age_split_pov, aes(x = year, y = net_pov, color = age_cat)) +
geom_bar(position="dodge", stat="identity")
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity")
ggplot(age_split_pov, aes(x = year, y = net_pov, fill = age_cat)) +
geom_bar(position="dodge", stat="identity")
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
facet_wrap(~age_cat)
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
geom_bar(aes(x = year, y = incpov), position="dodge", stat="identity") +
facet_wrap(~age_cat)
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
geom_bar(., aes(x = year, y = incom_pov), position="dodge", stat="identity") +
facet_wrap(~age_cat)
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
geom_bar(data = age_split_pov, aes(x = year, y = incom_pov), position="dodge", stat="identity") +
facet_wrap(~age_cat)
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
facet_wrap(~age_cat)
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
theme_ipsum() +
facet_wrap(~age_cat)
install.packages("hrbrthemes")
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
theme_ipsum() +
facet_wrap(~age_cat)
library(hrbrthemes)
ggplot(age_split_pov, aes(x = year, y = net_pov)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
View(age_split_pov)
melt(age_split_pov, id.vars=c('incom_pov','net_pov''))
)
)
?gather
age_split_pov %>%
gather(key = pov_type, value = value)
age_split_pov %>%
gather(key = pov_type, value = value, -n_)
age_split_pov %>%
gather(key = pov_type, value = value, net_pov, incom_pov)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
ggsave("age_split_bar_plots", plot = last_plot(), width = 10, height = 6,
device = "png", path = "~/Documents/GitHub/inc_net_poverty_project/")
?tidy_names
SCF_full <- tidy_names(SCF_full)
# read data
scf <- read_dta("rscfp2016.dta")
#EDIT
setwd("~/Documents/GitHub/Data-Analytics-Teaching-Material/")
# read data
scf <- read_dta("rscfp2016.dta")
names(scf)
scf$`401`
# Filter data
scf <- SCF_full %>%
select(incpov, nwpov, rnwpov, assetpov, income, networth, rnetworth,
haschild, numch, racecat, educcat, relstat, female, age, maxchage,
minchage, Y1, YY1, ID, obs, weight, year)
# Filter for those respondents who are children, or who have children in 2016 (most recent year)
children <- scf %>%
filter((age < 19 | numch > 0))
households_pov <- children %>% group_by(year) %>%
summarize(networth_poverty = weighted.mean(rnwpov, w = weight, na.rm = T),
income_poverty = weighted.mean(incpov, w = weight, na.rm = T))
longform_esitmates <- households_pov %>% gather(key = type, value = percentage, -year) # useful for plotting
age_splits <- children %>%
mutate(oldest_under6 = ifelse(maxchage < 6, 1, 0),
youngest_under6 = ifelse(minchage < 6, 1, 0),
youngest6_11 = ifelse(minchage >= 6 & minchage <= 11, 1, 0),
youngest_above11 = ifelse(minchage > 11 & minchage < 19, 1, 0),
lessthan4ch = ifelse(numch < 4, 1, 0),
morethan3ch = ifelse(numch > 3, 1, 0),
over65 = ifelse(maxchage >= 65, 1, 0)) %>%
select(YY1, rnwpov, incpov, year, minchage, maxchage, oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65,
lessthan4ch, morethan3ch, weight)
oldest_under6 <- age_splits %>%
group_by(year) %>%
filter(oldest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "oldest_under6")
View(over65)
check <- age_splits %>% filter(year > 2001)
View(check)
age_splits <- children %>%
mutate(oldest_under6 = ifelse(maxchage < 6, 1, 0),
youngest_under6 = ifelse(minchage < 6, 1, 0),
youngest6_11 = ifelse(minchage >= 6 & minchage <= 11, 1, 0),
youngest_above11 = ifelse(minchage > 11 & minchage < 19, 1, 0),
lessthan4ch = ifelse(numch < 4, 1, 0),
morethan3ch = ifelse(numch > 3, 1, 0),
over65 = ifelse(maxchage >= 65, 1, 0)) %>%
select(YY1, rnwpov, incpov, year, minchage, maxchage, oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65,
lessthan4ch, morethan3ch, weight, age)
check <- age_splits %>% filter(year > 2001)
View(check)
age_splits <- children %>%
mutate(oldest_under6 = ifelse(maxchage < 6, 1, 0),
youngest_under6 = ifelse(minchage < 6, 1, 0),
youngest6_11 = ifelse(minchage >= 6 & minchage <= 11, 1, 0),
youngest_above11 = ifelse(minchage > 11 & minchage < 19, 1, 0),
lessthan4ch = ifelse(numch < 4, 1, 0),
morethan3ch = ifelse(numch > 3, 1, 0),
over65 = ifelse(maxchage >= 65 | age >= 65, 1, 0)) %>%
select(YY1, rnwpov, incpov, year, minchage, maxchage, oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65,
lessthan4ch, morethan3ch, weight, age)
oldest_under6 <- age_splits %>%
group_by(year) %>%
filter(oldest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "oldest_under6")
youngest_under6 <- age_splits %>%
group_by(year) %>%
filter(youngest_under6 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest_under6")
youngest6_11 <- age_splits %>%
group_by(year) %>%
filter(youngest6_11 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest6_11")
youngest_above11 <- age_splits %>%
group_by(year) %>%
filter(youngest_above11 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "youngest_above11")
over65 <- age_splits %>%
group_by(year) %>%
filter(over65 == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "over65")
morethan3ch <- age_splits %>%
group_by(year) %>%
filter(morethan3ch == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "morethan3ch")
lessthan4ch <- age_splits %>%
group_by(year) %>%
filter(lessthan4ch == 1) %>%
summarise(net_pov = weighted.mean(rnwpov, weight, na.rm = T),
incom_pov = weighted.mean(incpov, weight, na.rm = T),
n_ = n()) %>%
mutate(age_cat = "lessthan4ch")
age_split_pov <- rbind(oldest_under6, youngest_under6, youngest6_11, youngest_above11, over65, morethan3ch, lessthan4ch)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
ggsave("age_split_bar_plots", plot = last_plot(), width = 10, height = 6,
device = "png", path = "~/Documents/GitHub/inc_net_poverty_project/")
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat) +
scale_x_discrete(labels = .$year)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat) +
scale_x_discrete(labels = unique(.$year))
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat) +
scale_x_discrete(labels = unique(age_split_pov$year))
unique(age_split_pov$year)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat) +
scale_x_discrete(breaks = unique(age_split_pov$year))
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat) +
scale_x_discrete(breaks = unique(age_split_pov$year))
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat) +
scale_x_discrete(breaks = unique(age_split_pov$year),
labels = unique(age_split_pov$year))
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(breaks = unique(age_split_pov$year),
labels = unique(age_split_pov$year)) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(breaks = unique(as.character(age_split_pov$year)),
labels = unique(as.charactre(age_split_pov$year))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(breaks = unique(as.character(age_split_pov$year)),
labels = unique(as.character(age_split_pov$year))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(breaks = c(unique(age_split_pov$year)),
labels = c(unique(age_split_pov$year))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(labels = unique(age_split_pov$year)) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
unique(age_split_pov$year)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(labels = as.character(unique(age_split_pov$year))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
as.character(unique(age_split_pov$year))
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_discrete(labels = c(as.character(unique(age_split_pov$year)))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(labels = c(as.character(unique(age_split_pov$year)))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = c(as.character(unique(age_split_pov$year))),
labels = c(as.character(unique(age_split_pov$year)))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
#hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() + theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() + theme(axis.text.x = element_text(angle = 50)) +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() + theme(axis.text.x = element_text(angle = 50, size = 2)) +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() + theme(axis.text.x = element_text(angle = 50, size = 5)) +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() + theme(axis.text.x = element_text(angle = 50, size = 10)) +
facet_wrap(~age_cat)
age_split_pov %>%
gather(key = pov_type, value = percent, net_pov, incom_pov) %>%
ggplot(aes(x = year, y = percent, fill = pov_type)) +
geom_bar(position="dodge", stat="identity") +
scale_x_continuous(breaks = unique(age_split_pov$year),
labels = c(as.character(unique(age_split_pov$year)))) +
hrbrthemes::theme_ipsum() + theme(axis.text.x = element_text(angle = 50, size = 8)) +
facet_wrap(~age_cat)
?wtd.quantile()
